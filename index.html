<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Entorno IDE con Ciudad</title>
    <link rel="stylesheet" href="styles.css">
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/eclipse.min.css">
</head>

<body>
    <!-- Barra de navegacion -->
    <nav>
        <button class="BtnNav" onclick="compilar()">Compilar</button>
        <button class="BtnNav" onclick="mostrarAyuda()">Ayuda</button>
        <button class="BtnNav" onclick="avanzar()">Avanzar</button>
        <button class="BtnNav" onclick="ejecutarRobot()">Ejecutar Robot</button>
        <div class="nav-right">
            <button class="toggle-panel-btn" onclick="togglePanel()" id="toggle-panel-btn">
                <span>‚óÄ</span> Panel
            </button>
            <button class="BtnNav theme-toggle" onclick="toggleTheme()">Tema Claro</button>
        </div>
    </nav>
    
    <!-- Contenido principal con scroll -->
    <div class="main-content">
        <!-- Entorno de ciudad cuadriculado -->
        <section class="ciudad-container">
            <div class="ciudad-header">
                <h3>Mapa de la Ciudad</h3>
                <div class="ciudad-controls">
                    <label for="tamano-ciudad">Tama√±o: </label>
                    <select id="tamano-ciudad" onchange="cambiarTamanoCiudad()">
                        <option value="50">50x50</option>
                        <option value="60">60x60</option>
                        <option value="70">70x70</option>
                        <option value="80">80x80</option>
                        <option value="90">90x90</option>
                        <option value="100">100x100</option>
                    </select>
                    
                    <label for="zoom-ciudad">Zoom: </label>
                    <input type="range" id="zoom-ciudad" min="5" max="20" value="10" oninput="actualizarZoom()">
                    
                    <button class="BtnNav" onclick="reiniciarCiudad()">Reiniciar</button>
                </div>
            </div>
            
            <div class="ciudad-grid-container">
                <div class="ciudad-grid" id="ciudad-grid">
                    <!-- La cuadr√≠cula se generar√° din√°micamente con JavaScript -->
                </div>
            </div>
            
            <div class="ciudad-info">
                <div class="robot-status" id="robot-status">
                    Robot: Inactivo | Posici√≥n: (0, 0)
                </div>
                <div class="objetos-count">
                    Objetos: <span id="contador-objetos">0</span> | 
                    Tama√±o: <span id="tamano-actual">50x50</span> | 
                    Zoom: <span id="zoom-value">10</span>%
                </div>
            </div>
        </section>
        
        <!-- Zona de trabajo -->
        <main class="VentanaPrincipal" id="ventana-principal">
            
            <section class="VentanaHerramientas" id="panel-control">
                <!-- Cabecera del panel de objetos con bot√≥n de minimizar -->
                <div class="panel-header" onclick="togglePanelContent()">
                    <h3>
                        <span>üì¶</span>
                        Panel de Objetos
                    </h3>
                    <button class="toggle-button" id="toggle-button">‚ñº</button>
                </div>
                
                <!-- Contenido del panel de objetos -->
                <div class="panel-content" id="panel-content">
                    <div class="apartadoObjetos">
                        <div class="ubicarObjetos">
                            <label for="objetosLista">Objeto:</label>
                            <select id="objetosLista" name="ObjetosLista">
                                <option value="flores">Flores</option>
                                <option value="papeles">Papeles</option>
                                <option value="arbol">√Årbol</option>
                                <option value="casa">Casa</option>
                            </select>
                            
                            <label for="avenidaPos">Avenida (X):</label>
                            <input type="number" id="avenidaPos" name="AvenidaPos" min="0" value="0">
                            
                            <label for="callePos">Calle (Y):</label>
                            <input type="number" id="callePos" name="CallePos" min="0" value="0">
                        </div>

                        <div class="declararObjetos">
                            <label for="cantidadObjeto">Cantidad:</label>
                            <input type="number" id="cantidadObjeto" name="CantidadObjeto" min="1" max="100" value="1">
                            <button class="BtnAgregar" onclick="agregarObjeto()">Agregar</button>
                        </div>
                        
                        <div class="objetos-agregados">
                            <h4>Objetos en escena:</h4>
                            <div id="contadores-objetos">
                                <p>Flores: <span id="contador-flores">0</span></p>
                                <p>Papeles: <span id="contador-papeles">0</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="controles-robot">
                        <h3>Velocidad del Robot</h3>
                        <div class="velocidad-robot">
                            <label for="velocidad">Velocidad: </label>
                            <input type="range" id="velocidad" min="1" max="10" value="5">
                            <span id="valor-velocidad">5</span>
                        </div>
                    </div>
                </div>
            </section>

            <section class="VentanaInteraccion" id="editor-section">
                <div class="editor-header">
                    <span>robot.r-info</span>
                    <div class="editor-options">
                        <button class="editor-btn" onclick="cargarCodigo()">Importar</button>
                        <button class="editor-btn" onclick="guardarCodigo()">Exportar</button>
                    </div>
                </div>
                <div class="editor-container" id="editor-container">
                    <div class="line-numbers" id="line-numbers">1</div>
                    <textarea id="seccionCodigo" style="display: none;">{Bienvenidos al entorno CMRE.
Lo siguiente es un c√≥digo de ejemplo que implementa un
proceso que recibe un n√∫mero de avenida como par√°metro,
se posiciona en esa avenida y la recorre.}

programa ejemplo
procesos
  proceso recorrerAvenida(E numAv: numero)
  comenzar
    Pos(numAv, 1)
    repetir 99
      mover
  fin
areas
  ciudad: AreaC (1,1,100,100)
robots
  robot robot1
  comenzar
    recorrerAvenida(1)
  fin
variables
  R_info: robot1
comenzar
  AsignarArea(R_info, ciudad)
  Iniciar(R_info, 1,1)
fin</textarea>
                </div>
                <!-- Barra de estado ahora dentro de la secci√≥n de c√≥digo -->
                <div class="status-bar">
                    <span id="cursor-position">Ln 1, Col 1</span>
                    <span id="file-info">R-Info</span>
                    <span id="code-stats">0 palabras, 0 l√≠neas</span>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Modal de Ayuda -->
    <div id="modal-ayuda" class="modal">
        <div class="modal-content">
            <span class="close" onclick="cerrarModal()">&times;</span>
            <h2>Ayuda del IDE - Lenguaje R-Info</h2>
            <div class="help-content">
                <h3>Instrucciones de control (resaltadas en celeste):</h3>
                <ul>
                    <li><code class="keyword">si</code> - Condicional if</li>
                    <li><code class="keyword">sino</code> - Condicional else</li>
                    <li><code class="keyword">mientras</code> - Bucle while</li>
                    <li><code class="keyword">repetir</code> - Bucle for</li>
                </ul>
                
                <h3>Funciones disponibles para el robot:</h3>
                <ul>
                    <li><code>mover</code> - Mueve el robot a la orientacion que apunta</li>
                    <li><code>Pos()</code> - Posiciona el robot en una ubicacion especifica de la ciudad que le corresponda</li>
                    <li><code>tomarFlor</code> - Recoge una flor en la posici√≥n actual</li>
                    <li><code>tomarPapel</code> - Recoge un papel en la posici√≥n actual</li>
                    <li><code>depositarFlor</code> - Deposita una flor en la posici√≥n actual</li>
                    <li><code>depositarPapel</code> - Deposita un papel en la posici√≥n actual</li>
                    <li><code>Informar()</code> - Informa en pantalla un dato</li>
                    <li><code>EnviarMensaje()</code> - Enviar un mensaje a un robot especifico</li>
                    <li><code>RecibirMensaje()</code> - Recibe un mensaje de un robot especifico</li>
                </ul>

                <h3>Funciones disponibles del entorno:</h3>
                <ul>
                    <li><code>HayFlorEnLaEsquina</code> - Indica con un booleano si en la ubicacion del robot existe por lo menos una flor</li>
                    <li><code>HayPapelEnLaEsquina</code> - Indica con un booleano si en la ubicacion del robot existe por lo menos un papel</li>
                    <li><code>HayFlorEnLaBolsa</code> - Indica con un booleano si el robot tiene por lo menos una flor en su bolsa</li>
                    <li><code>HayPapelEnLaBolsa</code> - Indica con un booleano si el robot tiene por lo menos un papel en su bolsa</li>
                    <li><code>PosCa</code> - Indica con un numero la ubicacion actual del robot en la calle de la ciudad</li>
                    <li><code>PosAv</code> - Indica con un numero la ubicacion actual del robot en la avenida de la ciudad</li>
                    <li><code>Random()</code> - Retorna un numero aleatorio a partir de lo que reciba por parametro</li>
                </ul>
                
                <h3>Ejemplo de estructura basica de un programa R-Info:</h3>
                <pre><code>programa

procesos {no es obligatoria su implementacion}

areas

robots

variables
comenzar

fin</code></pre>
                
                <h3>Atajos de teclado:</h3>
                <ul>
                    <li><kbd>Ctrl + S</kbd> - Guardar c√≥digo</li>
                    <li><kbd>Ctrl + O</kbd> - Abrir c√≥digo</li>
                    <li><kbd>Ctrl + /</kbd> - Comment/Uncomment line</li>
                </ul>
            </div>
        </div>
    </div>
    <!-- CodeMirror JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/comment/comment.min.js"></script>
    <script src="script.js"></script>
    <script src="lexer.js"></script>
    <script src="parser.js"></script>
    <script src="semantic.js"></script>
</body>
</html>